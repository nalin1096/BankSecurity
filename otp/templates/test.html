{% load staticfiles %}
<!DOCTYPE html>
<html class="no-js">
    <head>
        <!-- Basic Page Needs
        ================================================== -->
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>Examples</title>
        <meta name="description" content="">
        <meta name="keywords" content="">
        <meta name="author" content="">
        <!-- Mobile Specific Metas
        ================================================== -->
        <meta name="format-detection" content="telephone=no">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <!-- Template CSS Files
        ================================================== -->
        <!-- Twitter Bootstrs CSS -->
        <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
        <!-- Ionicons Fonts Css -->
        <link rel="stylesheet" href="{% static 'css/ionicons.min.css' %}">
        <!-- animate css -->
        <link rel="stylesheet" href="{% static 'css/animate.css' %}">
        <!-- Hero area slider css-->
        <link rel="stylesheet" href="{% static 'css/slider.css' %}">
        <!-- owl craousel css -->
        <link rel="stylesheet" href="{% static 'css/owl.carousel.css' %}">
        <link rel="stylesheet" href="{% static 'css/owl.theme.css' %}">
        <link rel="stylesheet" href="{% static 'css/jquery.fancybox.css' %}">
        <!-- template main css file -->
        <link rel="stylesheet" href="{% static 'css/main.css' %}">
        <!-- responsive css -->
        <link rel="stylesheet" href="{% static 'css/responsive.css' %}">
        
        <!-- Template Javascript Files
        ================================================== -->
        <!-- modernizr js -->
        <script src="{% static 'js/vendor/modernizr-2.6.2.min.js' %}"></script>
        <!-- jquery -->
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <!-- owl carouserl js -->
        <script src="{% static 'js/owl.carousel.min.js' %}"></script>
        <!-- bootstrap js -->

        <script src="{% static 'js/bootstrap.min.js' %}"></script>
        <!-- wow js -->
        <script src="{% static 'js/wow.min.js' %}"></script>
        <!-- slider js -->
        <script src="{% static 'js/slider.js' %}"></script>
        <script src="{% static 'js/jquery.fancybox.js' %}"></script>
        <!-- template main js -->
        <script src="{% static 'js/main.js' %}"></script>

        <meta id="first_digit" data-name="{{first_digit}}">
        <meta id="second_digit" data-name="{{second_digit}}">
        <meta id="third_digit" data-name="{{third_digit}}">
        <meta id="fourth_digit" data-name="{{fourth_digit}}">
        <meta id="fifth_digit" data-name="{{fifth_digit}}">
        <meta id="sixth_digit" data-name="{{sixth_digit}}">
        <meta id="random_number1" data-name="{{random_number1}}">
        <meta id="random_number2" data-name="{{random_number2}}">
    </head>

    <style>
            .logo-class {
                vertical-align: middle;
                margin-top:0px; /* need this to clear the default margin */
                margin-bottom:0px;
            }
    </style>
    <body>
        <!--
        ==================================================
        Header Section Start
        ================================================== -->
        <header id="top-bar" class="navbar-fixed-top animated-header">
            <div class="container">
                <div class="navbar-header">
                    <!-- responsive nav button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    </button>
                    <!-- /responsive nav button -->
                    
                    <!-- logo -->
                    <!-- <div class="navbar-brand"> -->
                        <a href="/" >
                            <h1 class="logo-class">VIRTUAL NET-BANKING</h1>
                        </a>
                    <!-- </div> -->
                    <!-- /logo -->
                </div>
                <!-- main menu -->
                <nav class="collapse navbar-collapse navbar-right" role="navigation">
                    <div class="main-menu">
                        <ul class="nav navbar-nav navbar-right">
                            <li>
                                <a href="/" >Home</a>
                            </li>
                            <li><a href="/about">About</a></li>
                            <li>
                            <form action="/login" method="get">
                            <input  type="submit" id="contact-submit" class="btn btn-default btn-send" value="LOGIN" style="margin-top: 7px;"></li> 
                            </form>
                        </ul>
                    </div>
                </nav>
                <!-- /main nav -->
            </div>
        </header>

        <!-- 
        ================================================== 
            Global Page Section Start
        ================================================== -->
        <section class="global-page-header">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="block">
                            <h2>OTP Examples</h2>
                        </div>
                    </div>
                </div>
            </div>   
        </section><!--/#page-header-->


        <!-- 
        ================================================== 
            Contact Section Start
        ================================================== -->
        <section id="contact-section">
            <div class="container">
                <div class="row">
                    <div class="col-md-3">
                    </div>
                    <div class="col-md-6">
                        <div class="block">
                            <p class="subtitle-des wow fadeInDown" data-wow-duration="500ms" data-wow-delay=".5s">
                                Please test out your given OTP Transformation. <!-- and fill in the transformed OTP as provided at time of registration. -->
                            </p>
                            <div class="contact-form">
                                <form action="/login/" id="login_form" method="post"> {% csrf_token %}
                        
                                    <div class="form-group wow fadeInDown" data-wow-duration="500ms" data-wow-delay=".6s">
                                    <center><h3>{{ random_number1 }}</h3></center>
                                        <input id = "inp1" type="text" placeholder="Example 1" class="form-control" name="Example 1">
                                    </div>
                                    <br>
                                    <div class="form-group wow fadeInDown" data-wow-duration="500ms" data-wow-delay=".8s">
                                    <center><h3>{{ random_number2 }}</h3></center>
                                        <input id="inp2" type="text" placeholder="Example 2" class="form-control" name="Example 2" >
                                    </div>
                                    
                                    <center>
                                    <div id="submit" class="wow fadeInDown" data-wow-duration="500ms" data-wow-delay="1s">
                                        <input type="submit" id="contact-submit" class="btn btn-default btn-send" value="SUBMIT">
                                    </div>   
                                    </center> 
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>


        <!-- 
        ================================================== 
            Footer Section Start
        ================================================== -->
        <center>
            <footer id="footer">
                <div class="container">
                        <p class="copyright">Copyright: <span>2016</span> . Design and Developed by devAlpha</p>
                </div>
            </footer> <!-- /#footer -->
        </center>


        <script type="text/javascript">

        function sub_func (digits,operand) {
            var operand_size = operand.length;
            var digit = operand[0];
            var num = 0;
            if (digit == 'a'){
                num = digits[0];
            }
            else if (digit == 'b'){
                num = digits[1];
            }
            else if (digit == 'c'){
                num = digits[2];
            }
            else if (digit == 'd'){
                num = digits[3];
            }
            else if (digit == 'e'){
                num = digits[4];
            }
            else if (digit == 'f'){
                num = digits[5];
            }

            modifier = operand.slice(1,operand_size)

            if (modifier == ''){
                num = num;
            }
            else if (modifier == '\''){
                num = (10-num) % 10;
            }
            else if (modifier == '~'){
                num = (9-num);
            }
            else if (modifier == '^2'){
                num = (num*num)%10;
            }

            return num;
        }

        function otp_extract (digits,func,index) {
            if (func==''){
                return digits[index];
            }
            var func_size = func.length;
            var operand1 = '';
            var operand2 = '';
            var operator = '';
            var flag = 0;
            for (i=0; i<func_size; i++){
                if (func[i] != '+' && func[i] != '*'){
                    operand1 = operand1 + func[i];
                }
                else {
                    flag = i;
                    break;
                }
            }
            operator = func[flag];
            
            for (i=flag+1; i<func_size; i++) {
                operand2 = operand2 + func[i];
            }

            sub1 = sub_func(digits,operand1);
            sub2 = sub_func(digits,operand2);

            if (operator=='+'){
                return (sub1+sub2)%10;
            }
            else if (operator=='*'){
                return (sub1*sub2)%10;
            }
        } 

        var first_digit = $('#first_digit').data().name;
        var second_digit = $('#second_digit').data().name;
        var third_digit = $('#third_digit').data().name;
        var fourth_digit = $('#fourth_digit').data().name;
        var fifth_digit = $('#fifth_digit').data().name;
        var sixth_digit = $('#sixth_digit').data().name;
        var random_number1 =  $('#random_number1').data().name;
        var random_number2 =  $('#random_number2').data().name;

        var temp1 = random_number1;
        var digits1 = [];   
        while (temp1!=0) {
            digits1.push(temp1%10);
            temp1 = Math.floor(temp1/10);
        }
        digits1 = digits1.reverse();

        var temp2 = random_number2;
        var digits2 = [];   
        while (temp2!=0) {
            digits2.push(temp2%10);
            temp2= Math.floor(temp2/10);
        }
        digits2 = digits2.reverse();

        var func1 = first_digit.replace(" ","");
        var func2 = second_digit.replace(" ","");
        var func3 = third_digit.replace(" ","");
        var func4 = fourth_digit.replace(" ","");
        var func5 = fifth_digit.replace(" ","");
        var func6 = sixth_digit.replace(" ","");

        var otp1 = otp_extract (digits1,func1,0);
        var otp2 = otp_extract (digits1,func2,1);
        var otp3 = otp_extract (digits1,func3,2);
        var otp4 = otp_extract (digits1,func4,3);
        var otp5 = otp_extract (digits1,func5,4);
        var otp6 = otp_extract (digits1,func6,5);

        var expected_otp1 = otp1.toString().concat(otp2.toString()+otp3.toString()+otp4.toString()+otp5.toString()+otp6.toString());

        otp1 = otp_extract (digits2,func1,0);
        otp2 = otp_extract (digits2,func2,1);
        otp3 = otp_extract (digits2,func3,2);
        otp4 = otp_extract (digits2,func4,3);
        otp5 = otp_extract (digits2,func5,4);
        otp6 = otp_extract (digits2,func6,5);

        var expected_otp2 = otp1.toString().concat(otp2.toString()+otp3.toString()+otp4.toString()+otp5.toString()+otp6.toString());

        console.log(expected_otp1);
        console.log(expected_otp2);

        var val1 = "";
        $("#inp1").keyup(function() {
            val1 = $(this).val();
            if (expected_otp1==val1) {
                $(this).css("color", "#00b200");
            }
            else {
                $(this).css("color","#ff0000");
            }
        }).change();

        var val2 = "";
        $("#inp2").keyup(function() {
            val2 = $(this).val();
            if (expected_otp2==val2) {
                $(this).css("color", "#00b200");
            }
            else {
                $(this).css("color","#ff0000");
            }
        }).change();
        

    </script>
    
    </body>
</html>


